<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>WAVLab | XEUS - Towards Robust Speech Representation Learning for Thousands of Languages</title>
<meta name="description" content="Webpage of Watanabe's Audio and Voice (WAV) Lab
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://raw.githubusercontent.com/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="/assets/img/favicon.png">

<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/activities/2024/xeus/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       WAVLab
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/blog/">
              Activities
              
            </a>
          </li>
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/members/">
                Members
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/open_source">
                Open-source
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/courses/">
                Courses
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/sponsors/">
                Sponsors
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/info/">
                Info
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/positions/">
                Positions
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/speech_lunch">
                Speech Lunch
                
              </a>
          </li>
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">XEUS - Towards Robust Speech Representation Learning for Thousands of Languages</h1>
    <p class="post-meta">June 30, 2024</p>
  </header>

  <article class="post-content">
    <h2 id="overview">Overview</h2>

<p><a href="https://www.wavlab.org/">WAVLab</a> at Carnegie Mellon University presents XEUS - a Cross-lingual Encoder for Universal Speech. XEUS (pronounced “Zeus”) is an open-source speech foundation model trained on nearly 1.1 million hours of unlabeled speech data across 4,057 languages. XEUS sets the new state-of-the-art on the ML-SUPERB multilingual speech recognition benchmark, while also achieving strong results on different tasks on the English-only SUPERB evaluations. We open-source XEUS’ checkpoints, along with our training code and 4,000+ language speech data in this project page.</p>

<p>Project Contacts: <a href="https://wanchichen.github.io/">William Chen</a>, <a href="https://sites.google.com/view/shinjiwatanabe">Shinji Watanabe</a></p>

<h2 id="model-info">Model Info</h2>

<p>XEUS is a 19-layer <a href="https://arxiv.org/abs/2210.00077">E-Branchformer</a> encoder trained using the <a href="https://arxiv.org/pdf/2106.07447">HuBERT</a> masked prediction objective. XEUS is trained on 37 public datasets, along with our crawled data detailed below. This totals to roughly 1.1 million hours of speech. From these audio files,  we generate 180 billion speech tokens as the prediction targets using a pre-trained <a href="https://arxiv.org/abs/2309.15317">WavLabLM</a>. We augment the training task with acoustic denoising from <a href="https://arxiv.org/abs/2110.13900">WavLM</a>, along with a new dereverberation objective that we propose. More details can be found in the <a href="https://wanchichen.github.io/pdf/xeus.pdf">paper</a>.</p>

<table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Data (hours)</th>
        <th>Parameters</th>
        <th>Model Link</th>
        <th>ESPnet Recipe</th>
        <th>License</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><b>XEUS</b></td>
        <td>1.1 million</td>
        <td>577M</td>
        <td><a href="https://huggingface.co/espnet/xeus">HuggingFace</a></td>
        <td><a href="">Coming soon</a></td>
        <td>MIT</td>
      </tr>
    </tbody>
</table>

<h2 id="released-data">Released Data</h2>

<table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Data (hours)</th>
        <th>Languages</th>
        <th>Link</th>
        <th>License</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><b>MMS ulab v2</b></td>
        <td>8,900</td>
        <td>4,023</td>
        <td><a href="https://huggingface.co/datasets/espnet/mms_ulab_v2">espnet/mms_ulab_v2</a></td>
        <td>CC BY-NC-SA 4.0</td>
      </tr>
      <tr>
        <td><b>WikiTongues</b></td>
        <td>70</td>
        <td>~700</td>
        <td><a href="https://huggingface.co/datasets/espnet/wikitongues">espnet/wikitongues</a></td>
        <td>CC BY-NC-SA 4.0</td>
      </tr>
      <tr>
        <td><b>JesusDramas</b></td>
        <td>645</td>
        <td>430</td>
        <td><a href="https://huggingface.co/datasets/espnet/jesus_dramas">espnet/jesus_dramas</a></td>
        <td>CC BY-NC-SA 4.0</td>
      </tr>
    </tbody>
</table>

<h2 id="intermediate-checkpoints-and-logs">Intermediate Checkpoints and Logs</h2>

<p>To encourage research on the training dynamics of large-scale speech models, we will also release the logs and intermediate checkpoints obtained from training XEUS. In total, we have around 200 total intermediate checkpoints. These will be made available in the near future.</p>

<h2 id="usage">Usage</h2>

<p>Similar to other ESPnet models, the pre-trained XEUS model can be downloaded and used in a python script. The code for XEUS is still in progress of being merged into the main ESPnet repo. It can instead be used from the following fork:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install 'espnet @ git+https://github.com/wanchichen/espnet.git@ssl'
git lfs install
git clone https://huggingface.co/espnet/XEUS
</code></pre></div></div>

<h3 id="feature-extraction">Feature Extraction</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">torch.nn.utils.rnn</span> <span class="kn">import</span> <span class="n">pad_sequence</span>
<span class="kn">from</span> <span class="n">espnet2.tasks.ssl</span> <span class="kn">import</span> <span class="n">SSLTask</span>
<span class="kn">import</span> <span class="n">soundfile</span> <span class="k">as</span> <span class="n">sf</span>

<span class="n">device</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cuda</span><span class="sh">"</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span>

<span class="n">xeus_model</span><span class="p">,</span> <span class="n">xeus_train_args</span> <span class="o">=</span> <span class="n">SSLTask</span><span class="p">.</span><span class="nf">build_model_from_file</span><span class="p">(</span>
    <span class="n">config</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">ckpt</span> <span class="o">=</span> <span class="sh">'</span><span class="s">/path/to/checkpoint/here/checkpoint.pth</span><span class="sh">'</span><span class="p">,</span>
    <span class="n">device</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">wavs</span><span class="p">,</span> <span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">sf</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="sh">'</span><span class="s">/path/to/audio.wav</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># sampling rate should be 16000
</span><span class="n">wav_lengths</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nc">LongTensor</span><span class="p">([</span><span class="nf">len</span><span class="p">(</span><span class="n">wav</span><span class="p">)</span> <span class="k">for</span> <span class="n">wav</span> <span class="ow">in</span> <span class="p">[</span><span class="n">wavs</span><span class="p">]]).</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">wavs</span> <span class="o">=</span> <span class="nf">pad_sequence</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nc">Tensor</span><span class="p">([</span><span class="n">wavs</span><span class="p">]),</span> <span class="n">batch_first</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> 

<span class="c1"># we recommend use_mask=True during fine-tuning
</span><span class="n">feats</span> <span class="o">=</span> <span class="n">xeus_model</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">wavs</span><span class="p">,</span> <span class="n">wav_lengths</span><span class="p">,</span> <span class="n">use_mask</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_final_output</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># take the output of the last layer -&gt; batch_size x seq_len x hdim
</span></code></pre></div></div>

<h3 id="flash-attention">Flash Attention</h3>

<p>XEUS supports Flash Attention for more efficient training.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install flash-attn --no-build-isolation
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">layer</span><span class="p">.</span><span class="n">use_flash_attn</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">xeus_model</span><span class="p">.</span><span class="n">encoder</span><span class="p">.</span><span class="n">encoders</span><span class="p">]</span>

<span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">amp</span><span class="p">.</span><span class="nf">autocast</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">bfloat16</span><span class="p">):</span>
  <span class="n">feats</span> <span class="o">=</span> <span class="n">xeus_model</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">wavs</span><span class="p">,</span> <span class="n">wav_lengths</span><span class="p">,</span> <span class="n">use_mask</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_final_output</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="masking">Masking</h3>

<p>The masking settings can be tuned to better fit certain downstream tasks during fine-tuning.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xeus_model</span><span class="p">.</span><span class="n">masker</span><span class="p">.</span><span class="n">mask_prob</span> <span class="o">=</span> <span class="mf">0.65</span> <span class="c1"># default 0.8
</span><span class="n">xeus_model</span><span class="p">.</span><span class="n">masker</span><span class="p">.</span><span class="n">mask_length</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># default 10
</span><span class="n">xeus_model</span><span class="p">.</span><span class="n">masker</span><span class="p">.</span><span class="n">mask_selection</span> <span class="o">=</span> <span class="sh">'</span><span class="s">static</span><span class="sh">'</span> <span class="c1"># default 'uniform'
</span><span class="n">xeus_model</span><span class="p">.</span><span class="nf">train</span><span class="p">()</span>
<span class="n">feats</span> <span class="o">=</span> <span class="n">xeus_model</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">wavs</span><span class="p">,</span> <span class="n">wav_lengths</span><span class="p">,</span> <span class="n">use_mask</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_final_output</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="papers">Papers</h2>

<p>If you use XEUS or our released data in your project, please consider citing the paper.</p>

<ul>
  <li>Preprint: <a href="https://wanchichen.github.io/pdf/xeus.pdf">Towards Robust Speech Representation Learning for Thousands of Languages</a></li>
</ul>


  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2025   WAV Lab.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
